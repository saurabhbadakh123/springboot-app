trigger:
- main

steps:
# Step 1: Build and push to ACR
- script: |
    docker build -t pythonappacr123.azurecr.io/python-app:latest .
    az acr login --name pythonappacr123
    docker push pythonappacr123.azurecr.io/python-app:latest
  displayName: 'Build and Push'

# Step 2: Deploy to AKS
- script: |
    az aks get-credentials --resource-group pythonapp-rg --name pythonapp-aks --overwrite-existing
    kubectl apply -f k8s-deployment.yml
  displayName: 'Deploy'
