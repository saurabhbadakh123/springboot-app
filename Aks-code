- task: AzureCLI@2
  displayName: 'Deploy & Restart'
  inputs:
    azureSubscription: 'service-connection'
    scriptType: 'bash'
    scriptLocation: 'inlineScript'
    inlineScript: |
      # Apply deployment
      kubectl apply -f k8s-deployment.yml
      
      # Force restart
      kubectl rollout restart deployment/python-app -n default
      
      # Monitor progress
      kubectl rollout status deployment/python-app -n default --timeout=120s
      
      # Final verification
      kubectl get pods -n default -w
      echo "Pod restart completed successfully"
