- task: AzureCLI@2
  displayName: 'Deploy to AKS'
  inputs:
    azureSubscription: 'service-connection'
    scriptType: 'bash'
    scriptLocation: 'inlineScript'
    inlineScript: |
      az aks get-credentials -n pythonapp-aks -g pythonapp-rg --overwrite-existing
      
      # Apply changes
      kubectl apply -f k8s-deployment.yml
      
      # Force new pods
      kubectl rollout restart deployment/python-app
      kubectl rollout status deployment/python-app --timeout=90s
      
      # Verify
      kubectl get pods -w
